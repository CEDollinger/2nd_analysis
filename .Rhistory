#     group_by(species) %>% summarise(a=mean(basal_area_m2)) %>% arrange(desc(a)) %>% slice(1:8) %>%
#     pull(species))
common.stoko <- c("beer", "absa", "acmo", "kase", "qumo", "alhi", "tacu", "soco")
common.species <- list(common.bgd, common.grte, common.stoko); names(common.species) <- landscapes; rm(common.bgd, common.grte, common.stoko)
helpers <- list(list(), list(), list(), tibble(), tibble()); names(helpers) <- c("ru", "stand", "elev", "species", "env")
helper.files <- list(helpers, helpers, helpers); names(helper.files) <- landscapes; rm(helpers)
helper.files[["bgd"]][["ru"]] <- rast("../project2ndStudy/projectTest_bgd/gis/objectid.asc")
helper.files[["bgd"]][["stand"]] <- rast("../project2ndStudy/projectTest_bgd/gis/standgrid.asc")
helper.files[["bgd"]][["elev"]] <- rast("../project2ndStudy/projectTest_bgd/gis/dem100_rid.asc") %>%
resample(., helper.files[["bgd"]][["ru"]])
helper.files[["bgd"]][["species"]] <- dbConnect(RSQLite::SQLite(),  dbname = "../project2ndStudy/projectTest_bgd/database/species_bgd.sqlite") %>%
tbl(., "species") %>% collect() %>% dplyr::select(shortName, lightResponseClass, isConiferous, sapHDSapling, psiMin) %>%
rename(species = shortName) %>% mutate(lightResponseClass = as.numeric(lightResponseClass)) %>%
mutate(species.code = as.numeric(as.factor(species))) %>%
mutate(species.code = ifelse(species %in% common.species[["bgd"]], species.code, 0))
helper.files[["bgd"]][["env"]] <- read_delim("../project2ndStudy/projectTest_bgd/gis/environment.txt")
helper.files[["grte"]][["ru"]] <- rast("../project2ndStudy/projectTest_grte/gis/landscape_env_grid.txt")
helper.files[["grte"]][["stand"]] <- rast("../project2ndStudy/projectTest_grte/gis/landscape_stand_grid.txt")
helper.files[["grte"]][["elev"]] <- rast("../project2ndStudy/projectTest_grte/gis/landscape_DEM.txt") %>%
resample(., helper.files[["grte"]][["ru"]])
helper.files[["grte"]][["species"]] <- dbConnect(RSQLite::SQLite(),  dbname = "../project2ndStudy/projectTest_grte/database/species_grte.sqlite") %>%
tbl(., "species") %>% collect() %>% dplyr::select(shortName, lightResponseClass, isConiferous, sapHDSapling, psiMin) %>%
rename(species = shortName) %>% mutate(lightResponseClass = as.numeric(lightResponseClass)) %>%
mutate(species.code = as.numeric(as.factor(species))) %>%
filter(species %ni% c("Potr_backup", "Pial_backup_org", "Pico_backup")) %>%
mutate(species.code = ifelse(species %in% common.species$grte, species.code, 0))
helper.files[["grte"]][["env"]] <- read_delim("../project2ndStudy/projectTest_grte/gis/environment_file_cluster_kbdi_downscaledclimate.txt")
helper.files[["stoko"]][["ru"]] <- rast("../project2ndStudy/projectTest_stoko/gis/resourceUnit_snp_220908.asc")
helper.files[["stoko"]][["stand"]] <- rast("../project2ndStudy/projectTest_stoko/gis/standgrid_speed.asc")
helper.files[["stoko"]][["elev"]] <- rast("../project2ndStudy/projectTest_stoko/gis/jpn_elv_clipClim_JGD2000Zone13_res100m_cropped.asc") %>%
resample(., helper.files[["stoko"]][["ru"]])
helper.files[["stoko"]][["species"]] <- dbConnect(RSQLite::SQLite(),  dbname = "../project2ndStudy/projectTest_stoko/database/species_stoko.sqlite") %>%
tbl(., "speciesParameters") %>% collect() %>% dplyr::select(shortName, lightResponseClass, isConiferous, sapHDSapling, psiMin) %>%
rename(species = shortName) %>% mutate(lightResponseClass = as.numeric(lightResponseClass)) %>%
mutate(species.code = as.numeric(as.factor(species))) %>%
mutate(species.code = ifelse(species %in% common.species$stoko, species.code, 0))
helper.files[["stoko"]][["env"]] <- read_delim("../project2ndStudy/projectTest_stoko/gis/environment_final.txt")
rid.df <- data.frame()
for (landscape in 1:3) {
rid_i <-helper.files[[landscapes[landscape]]][["ru"]] %>%
terra::as.data.frame(., xy=T) %>% rename(rid=3) %>%
drop_na() %>% mutate(landscape = landscapes[landscape])
if (landscape == 3) rid_i <- rid_i %>% filter(rid %in% keep.stoko)
rid.df <- bind_rows(rid.df, rid_i);rm(rid_i)
}; rm(keep.stoko)
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# discarded
# reorg.ls<-readRDS("raw_data/helper_files/reorg.ls.RDATA")
# keep <- reorg.ls[["stoko"]] %>% summarise(unique=unique(rid)) %>% pull(unique)
# write_csv(as.data.frame(keep), "raw_data/helper_files/keep.csv")
landscapename <- "bgd"
db.conn <- dbConnect(RSQLite::SQLite(), paste0("raw_data/breakingTheSystem_", toupper(landscapename) ,"_Results/data1/output.sqlite"))
ls.bgd <- tbl(db.conn, "landscape") %>% collect() %>% mutate(landscape = landscapename)
dbDisconnect(db.conn); rm(db.conn)
landscapename <- "stoko"
db.conn <- dbConnect(RSQLite::SQLite(), paste0("raw_data/breakingTheSystem_", toupper(landscapename) ,"_Results/data1/output.sqlite"))
ls.stoko <- tbl(db.conn, "landscape") %>% collect() %>% mutate(landscape = landscapename)
dbDisconnect(db.conn); rm(db.conn)
landscapename <- "grte"
db.conn <- dbConnect(RSQLite::SQLite(), paste0("raw_data/breakingTheSystem_", toupper(landscapename) ,"_Results/data1/output.sqlite"))
ls.grte <- tbl(db.conn, "landscape") %>% collect() %>% mutate(landscape = landscapename)
dbDisconnect(db.conn); rm(db.conn)
bind_rows(ls.bgd, ls.stoko, ls.grte) %>%
filter(species %ni% c("pice", "weer", "pimu")) %>% # filter shrub species
group_by(year, landscape) %>%
summarise(regen = sum(cohort_count_ha),
density = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
summarise(regen_mean = round(mean(regen)),
density_mean = round(mean(density)))
bind_rows(ls.bgd, ls.stoko, ls.grte) %>%
filter(species %ni% c("pice", "weer", "pimu")) %>% # filter shrub species
group_by(year, landscape) %>%
summarise(regen = sum(cohort_count_ha),
density = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
summarise(regen_mean = round(mean(regen)),
density_mean = round(mean(density)),
ratio = regen_mean/density_mean)
bind_rows(ls.bgd, ls.stoko, ls.grte) %>%
#filter(species %ni% c("pice", "weer", "pimu")) %>% # filter shrub species
group_by(year, landscape) %>%
summarise(regen = sum(cohort_count_ha),
density = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
summarise(regen_mean = round(mean(regen)),
density_mean = round(mean(density)),
ratio = regen_mean/density_mean)
bind_rows(ls.bgd, ls.stoko, ls.grte) %>%
filter(species %ni% c("pice", "weer", "pimu")) %>% # filter shrub species
ggplot(aes(x=year, y=cohort_count_ha, fill=species)) +
geom_bar(stat="identity", width=1.01) +
facet_wrap(~landscape) +
theme_bw()
bind_rows(ls.bgd, ls.stoko, ls.grte) %>%
filter(species %ni% c("pice", "weer", "pimu")) %>% # filter shrub species
group_by(year, landscape) %>%
summarise(regen = sum(cohort_count_ha),
density = sum(count_ha),
basal = sum(basal_area_m2)) %>% ungroup() %>%
group_by(landscape) %>%
summarise(regen_mean = round(mean(regen)),
density_mean = round(mean(density)),
basal_mean = round(mean(basal)),
ratio = regen_mean/density_mean)
bind_rows(ls.bgd, ls.stoko, ls.grte) %>%
filter(species %ni% c("pice", "weer", "pimu")) %>% # filter shrub species
group_by(year, landscape) %>%
summarise(regen = sum(cohort_count_ha),
density = sum(count_ha),
basal = sum(basal_area_m2)) %>% ungroup() %>%
group_by(landscape) %>%
summarise(regen_mean = round(mean(regen)),
density_mean = round(mean(density)),
basal_mean = round(mean(basal)))
getwd()
?lag
ls.bgd %>%
mutate(count_previous = lag(count_ha))
ls.bgd %>%
dplyr::select(year, landscape, count_ha) %>%
mutate(count_previous = lag(count_ha))
i<-1
areas[i, "area"]
areas[i, "area"]*1
areas[i, "area"]*2
ls.bgd %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha))
bind_rows(ls.bgd, ls.stoko, ls.grte) %>%
filter(species %ni% c("pice", "weer", "pimu")) %>% # filter shrub species
group_by(year, landscape) %>%
summarise(regen = sum(cohort_count_ha),
density = sum(count_ha),
basal = sum(basal_area_m2)) %>% ungroup() %>%
group_by(landscape) %>%
summarise(regen_mean = round(mean(regen)),
density_mean = round(mean(density)),
basal_mean = round(mean(basal)))
ls.bgd %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup()
ls.bgd %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count_previous = lag(count.sum))
ls.bgd %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
filter(year > 0) %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = )
ls.bgd %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
filter(year > 0)
ls.bgd %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
filter(year > 0) %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous)
ls.bgd %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>%
filter(year > 0)
dbname <- paste0("raw_data/helper_files/", landscapename,"_recruitmentRate.sqlite")
dbname
ls <- data.frame(); rem <- data.frame()
for (i in 1:1) {
landscapename <- landscapes[i]
dbname <- paste0("raw_data/helper_files/", landscapename,"_recruitmentRate.sqlite")
db.conn <- dbConnect(RSQLite::SQLite(), dbname)
ls_i <- tbl(db.conn, "landscape") %>% collect() %>% mutate(landscape = landscapename)
rem_i <- tbl(db.conn, "landscape_removed") %>% collect() %>% mutate(landscape = landscapename,
count_ha = count/areas[i, "area"])
dbDisconnect(db.conn); rm(db.conn)
ls <- bind_rows(ls, ls_i); rm(ls_i)
rem <- bind_rows(rem, rem_i); rm(rem_i)
}
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup()
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year > 0)
rem %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count)), by = c("year", "landscape") %>% ungroup()
rem %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count)) %>% ungroup()
db.conn <- dbConnect(RSQLite::SQLite(), dbname)
rem_i <- tbl(db.conn, "landscape_removed") %>% collect() %>% mutate(landscape = landscapename,
count_ha = count/areas[i, "area"])
View(rem_i)
rem %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count_ha)) %>% ungroup()
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year > 0) %>%
full_join(rem %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died)
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year > 0) %>%
full_join(rem %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born))
ls <- data.frame(); rem <- data.frame()
for (i in c(1,3)) {
landscapename <- landscapes[i]
dbname <- paste0("raw_data/helper_files/", landscapename,"_recruitmentRate.sqlite")
db.conn <- dbConnect(RSQLite::SQLite(), dbname)
ls_i <- tbl(db.conn, "landscape") %>% collect() %>% mutate(landscape = landscapename)
rem_i <- tbl(db.conn, "landscape_removed") %>% collect() %>% mutate(landscape = landscapename,
count_ha = count/areas[i, "area"])
dbDisconnect(db.conn); rm(db.conn)
ls <- bind_rows(ls, ls_i); rm(ls_i)
rem <- bind_rows(rem, rem_i); rm(rem_i)
}
View(ls)
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) # mean number of trees that are recruited per year and hectare
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20)
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) # mean number of trees that are recruited per year and hectare
rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count_ha)) %>% ungroup()
rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count_ha)) %>% ungroup() %>% ggplot(aes(x=year,y=died,col=landscape)) + geom_line()
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died)
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>% summary()
areas[i, "area"]
rem %>% summary()
rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + death causes
summarise(died = sum(count_ha)) %>% ungroup()
rem %>%
filter(year %in% 1:20)
rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year)
rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha))
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) # mean number of trees that are recruited per year and hectare
ls <- data.frame(); rem <- data.frame()
for (i in c(1:3)) {
landscapename <- landscapes[i]
dbname <- paste0("raw_data/helper_files/", landscapename,"_recruitmentRate.sqlite")
db.conn <- dbConnect(RSQLite::SQLite(), dbname)
ls_i <- tbl(db.conn, "landscape") %>% collect() %>% mutate(landscape = landscapename)
rem_i <- tbl(db.conn, "landscape_removed") %>% collect() %>% mutate(landscape = landscapename,
count_ha = count/areas[i, "area"])
dbDisconnect(db.conn); rm(db.conn)
ls <- bind_rows(ls, ls_i); rm(ls_i)
rem <- bind_rows(rem, rem_i); rm(rem_i)
}
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) # mean number of trees that are recruited per year and hectare
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) # mean number of trees that are recruited per year and hectare %>% ggplot(aes(x=1, y=born_mean, fill=landscape)) + geom_bar(stat="identity")
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) %>% ggplot(aes(x=1, y=born_mean, fill=landscape)) + geom_bar(stat="identity")
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) %>% ggplot(aes(x=1, y=born_mean, fill=landscape)) + geom_bar(stat="identity") + coord_circular()
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) %>% ggplot(aes(x=1, y=born_mean, fill=landscape)) + geom_bar(stat="identity") + coord_polar()
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) %>% ggplot(aes(x=1, y=born_mean, fill=landscape)) + geom_bar(stat="identity") + coord_polar("y")
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) %>% ggplot(aes(x=1, y=born_mean, fill=landscape)) + geom_bar(stat="identity") + coord_polar("y", start=0)
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) %>% ggplot(aes(x=1, y=born_mean, fill=landscape)) + geom_bar(stat="identity") + coord_polar("y", start=1)
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) %>% ggplot(aes(x=1, y=born_mean, fill=landscape)) + geom_bar(stat="identity") + coord_polar("y", start=1) + theme_minimal()
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(born_mean = mean(born)) # mean number of trees that are recruited per year and hectare
ls %>%
group_by(landscape, year) %>%
summarise(count.sum = sum(count_ha)) %>% ungroup() %>%
group_by(landscape) %>%
mutate(count.previous = lag(count.sum),
zuwachs = count.sum - count.previous) %>% ungroup() %>%
filter(year %in% 1:20) %>%
full_join(rem %>%
filter(year %in% 1:20) %>%
group_by(landscape, year) %>% # sum up over species + causes of death
summarise(died = sum(count_ha)) %>% ungroup(), by = c("year", "landscape")) %>%
mutate(born = zuwachs + died) %>%
group_by(landscape) %>%
summarise(recruited_mean = mean(born)) # mean number of trees that are recruited per year and hectare
conributors()
contributors()
