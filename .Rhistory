geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = T) +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "darkorange", "Amplifying"="orchid4"),
labels = c("Dampening", "Amplifying")) +
theme_bw()
a %>%
ggplot() +
geom_rect(data=background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "darkorange", "Amplifying"="orchid4"),
labels = c("Dampening", "Amplifying")) +
theme_bw()
a %>%
ggplot() +
geom_rect(data=background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#f77f00", "Amplifying"="#0a9396"),
labels = c("Dampening", "Amplifying")) +
theme_bw()
a %>%
ggplot() +
geom_rect(data=background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#bb3e03", "Amplifying"="#0a9396"),
labels = c("Dampening", "Amplifying")) +
theme_bw()
a %>%
ggplot() +
geom_rect(data=background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#ae2012", "Amplifying"="#ae2"),
labels = c("Dampening", "Amplifying")) +
theme_bw()
a %>%
ggplot() +
geom_rect(data=background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#ae2012", "Amplifying"="#32CD32"),
labels = c("Dampening", "Amplifying")) +
theme_bw()
a %>%
ggplot() +
geom_rect(data=background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening", "Amplifying")) +
theme_bw()
dist.dyn.effect <- dist.dyn.df_climate %>%
filter(climate=="baseline") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(baseline=value, dist.dyn_baseline=dist.dyn) %>%
full_join(dist.dyn.df_climate %>% filter(climate=="hotdry") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(hotdry=value, dist.dyn_hotdry=dist.dyn)) %>%
mutate(effect = hotdry-baseline) # positive when hotdry > baseline -> dampening effect
dist.dyn.effect <- dist.dyn.df_climate %>%
filter(climate=="baseline") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(baseline=value, dist.dyn_baseline=dist.dyn) %>%
full_join(dist.dyn.df_climate %>% filter(climate=="hotdry") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(hotdry=value, dist.dyn_hotdry=dist.dyn)) %>%
mutate(effect = hotdry-baseline) # positive when hotdry > baseline -> dampening effect
summary(dist.dyn.effect)
effect.background <- data.frame(interaction = factor(c("Dampening", "Amplifying"), levels=c("Dampening", "Amplifying")),
xmin = c(0, 0), xmax = c(Inf, Inf),
ymin = c(0, -Inf), ymax = c(Inf, 0))
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening", "Amplifying")) +
theme_bw()
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening", "Amplifying")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed")
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening", "Amplifying")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
png("results/figures/Q2_climateEffect_disturbanceRate_10yrs.png", res=200,
height=1300, width=2000)
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening", "Amplifying")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dev.off()
png("results/figures/Q2_responseLine_disturbanceRate_climate_10yrs.png", res=200,
height=1300, width=2000)
dist.dyn.df_climate  %>%
ggplot(aes(x = dist.dyn, y = value*100, col=climate)) +
geom_point(size = 0.1, alpha = 0.5) +
geom_smooth(method = "loess", se = FALSE) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2, # year 1:80 *0.5, 1:10 *2, 1:5 *5, 1:2 *10
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
facet_grid(~name) +
scale_color_manual(values=c("hotdry" = "firebrick2", "baseline"="royalblue3")) +
ylim(0, 100) +
labs(y = "Landscape unchanged [%]", col = "Climate scenario",
x = paste0("Simulated disturbance rate [% yr^-1]\nRate based on only the first ", unique(dist.dyn.df_climate$n_year)," simulation years\nAxis log10-transformed")) +
theme_bw() +
theme(legend.position = "top")
dev.off()
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# Set up ###########################################################################################################################################
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
library(tidyverse)
library(ggpubr)
library(RSQLite); library(dbplyr)
library(terra)
library(beepr)
"%ni%" <- Negate("%in%")
options(dplyr.summarise.inform = FALSE, readr.show_col_types = FALSE)
#setwd(dirname(rstudioapi::getActiveDocumentContext()$path)); getwd() # set wd to file location
landscapes <- c("bgd", "grte", "stoko")
vars <- c("size", "freq", "fecundity", "browsing")
keep.stoko <- read_csv("raw_data/helper_files/keep.csv") %>% pull(keep)
areas <- data.frame(area = c(8645, 42586, 35676), landscape=landscapes) # forested landscape area in ha, "bgd", "grte", "stoko"
#
# set up ####
# Most common species ###
# (common.bgd <- dbConnect(RSQLite::SQLite(), "raw_data/breakingTheSystem_BGD_Results/data1/output.sqlite") %>%
#    tbl(., "landscape") %>% collect() %>%
#    group_by(species) %>% summarise(a=mean(basal_area_m2)) %>% arrange(desc(a)) %>% slice(1:8) %>% pull(species))
common.bgd <- c("piab", "lade", "fasy", "pice", "abal", "acps", "frex", "soau")
# (common.grte <- dbConnect(RSQLite::SQLite(), "raw_data/breakingTheSystem_GRTE_Results/data1/output.sqlite") %>%
#     tbl(., "landscape") %>% collect() %>%
#     group_by(species) %>% summarise(a=mean(basal_area_m2)) %>% arrange(desc(a)) %>% slice(1:8) %>% pull(species))
common.grte <- c("Pico", "Psme", "PicS", "Pien", "Potr", "Abla", "Pial")
# (common.stoko <- dbConnect(RSQLite::SQLite(), "raw_data/breakingTheSystem_STOKO_Results/data1/output.sqlite") %>%
#     tbl(., "landscape") %>% collect() %>%
#     group_by(species) %>% summarise(a=mean(basal_area_m2)) %>% arrange(desc(a)) %>% slice(1:8) %>%
#     pull(species))
common.stoko <- c("beer", "absa", "acmo", "kase", "qumo", "alhi", "tacu", "soco")
common.species <- list(common.bgd, common.grte, common.stoko); names(common.species) <- landscapes; rm(common.bgd, common.grte, common.stoko)
helpers <- list(list(), list(), list(), tibble(), tibble()); names(helpers) <- c("ru", "stand", "elev", "species", "env")
helper.files <- list(helpers, helpers, helpers); names(helper.files) <- landscapes; rm(helpers)
helper.files[["bgd"]][["ru"]] <- rast("../project2ndStudy/projectTest_bgd/gis/objectid.asc")
helper.files[["bgd"]][["stand"]] <- rast("../project2ndStudy/projectTest_bgd/gis/standgrid.asc")
helper.files[["bgd"]][["elev"]] <- rast("../project2ndStudy/projectTest_bgd/gis/dem100_rid.asc") %>%
resample(., helper.files[["bgd"]][["ru"]])
helper.files[["bgd"]][["species"]] <- dbConnect(RSQLite::SQLite(),  dbname = "../project2ndStudy/projectTest_bgd/database/species_bgd.sqlite") %>%
tbl(., "species") %>% collect() %>% dplyr::select(shortName, lightResponseClass, isConiferous, sapHDSapling, psiMin) %>%
rename(species = shortName) %>% mutate(lightResponseClass = as.numeric(lightResponseClass)) %>%
mutate(species.code = as.numeric(as.factor(species))) %>%
mutate(species.code = ifelse(species %in% common.species[["bgd"]], species.code, 0))
helper.files[["bgd"]][["env"]] <- read_delim("../project2ndStudy/projectTest_bgd/gis/environment.txt")
helper.files[["grte"]][["ru"]] <- rast("../project2ndStudy/projectTest_grte/gis/landscape_env_grid.txt")
helper.files[["grte"]][["stand"]] <- rast("../project2ndStudy/projectTest_grte/gis/landscape_stand_grid.txt")
helper.files[["grte"]][["elev"]] <- rast("../project2ndStudy/projectTest_grte/gis/landscape_DEM.txt") %>%
resample(., helper.files[["grte"]][["ru"]])
helper.files[["grte"]][["species"]] <- dbConnect(RSQLite::SQLite(),  dbname = "../project2ndStudy/projectTest_grte/database/species_grte.sqlite") %>%
tbl(., "species") %>% collect() %>% dplyr::select(shortName, lightResponseClass, isConiferous, sapHDSapling, psiMin) %>%
rename(species = shortName) %>% mutate(lightResponseClass = as.numeric(lightResponseClass)) %>%
mutate(species.code = as.numeric(as.factor(species))) %>%
filter(species %ni% c("Potr_backup", "Pial_backup_org", "Pico_backup")) %>%
mutate(species.code = ifelse(species %in% common.species$grte, species.code, 0))
helper.files[["grte"]][["env"]] <- read_delim("../project2ndStudy/projectTest_grte/gis/environment_file_cluster_kbdi_downscaledclimate.txt")
helper.files[["stoko"]][["ru"]] <- rast("../project2ndStudy/projectTest_stoko/gis/resourceUnit_snp_220908.asc")
helper.files[["stoko"]][["stand"]] <- rast("../project2ndStudy/projectTest_stoko/gis/standgrid_speed.asc")
helper.files[["stoko"]][["elev"]] <- rast("../project2ndStudy/projectTest_stoko/gis/jpn_elv_clipClim_JGD2000Zone13_res100m_cropped.asc") %>%
resample(., helper.files[["stoko"]][["ru"]])
helper.files[["stoko"]][["species"]] <- dbConnect(RSQLite::SQLite(),  dbname = "../project2ndStudy/projectTest_stoko/database/species_stoko.sqlite") %>%
tbl(., "speciesParameters") %>% collect() %>% dplyr::select(shortName, lightResponseClass, isConiferous, sapHDSapling, psiMin) %>%
rename(species = shortName) %>% mutate(lightResponseClass = as.numeric(lightResponseClass)) %>%
mutate(species.code = as.numeric(as.factor(species))) %>%
mutate(species.code = ifelse(species %in% common.species$stoko, species.code, 0))
helper.files[["stoko"]][["env"]] <- read_delim("../project2ndStudy/projectTest_stoko/gis/environment_final.txt")
rid.df <- data.frame()
for (landscape in 1:3) {
rid_i <-helper.files[[landscapes[landscape]]][["ru"]] %>%
terra::as.data.frame(., xy=T) %>% rename(rid=3) %>%
drop_na() %>% mutate(landscape = landscapes[landscape])
if (landscape == 3) rid_i <- rid_i %>% filter(rid %in% keep.stoko)
rid.df <- bind_rows(rid.df, rid_i);rm(rid_i)
}; rm(keep.stoko)
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# discarded
# reorg.ls<-readRDS("raw_data/helper_files/reorg.ls.RDATA")
# keep <- reorg.ls[["stoko"]] %>% summarise(unique=unique(rid)) %>% pull(unique)
# write_csv(as.data.frame(keep), "raw_data/helper_files/keep.csv")
dist.dyn.effect <- dist.dyn.df_climate %>%
filter(climate=="baseline") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(baseline=value, dist.dyn_baseline=dist.dyn) %>%
full_join(dist.dyn.df_climate %>% filter(climate=="hotdry") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(hotdry=value, dist.dyn_hotdry=dist.dyn)) %>%
mutate(effect = hotdry-baseline) # positive when hotdry > baseline -> dampening effect
## line plots ####
overtime.ls <- readRDS("results/datasets/overtime.ls.RDATA")
patch.df <- bind_rows(readRDS("results/datasets/patch_bgd_backup.RDATA"),
readRDS("results/datasets/patch_grte_backup.RDATA"),
readRDS("results/datasets/patch_stoko_backup.RDATA")) %>%
group_by(landscape, climate, rep, size, freq, browsing, fecundity, year) %>% # don't group by agent
summarise(area_disturbed = sum(n_cells)) %>%
mutate(size = factor(size, levels = rev(c("10", "5", "2", "1"))),
freq = factor(freq, levels = rev(c("10", "5", "2", "1"))),
fecundity = factor(fecundity, levels = c("100", "50", "20", "10")),
browsing = factor(browsing, levels = rev(c("10", "5", "2", "1")))) %>%
full_join(areas, by="landscape")
dist.dyn.df_climate <- bind_rows(overtime.ls[["bgd"]], overtime.ls[["grte"]],overtime.ls[["stoko"]]) %>%
filter(year==80) %>% dplyr::select(-year) %>%
full_join(patch.df %>%
filter(year %in% 1:10) %>%
group_by(climate, size, freq, browsing, fecundity, landscape, rep, area) %>%
# mean yearly disturbance rate: area_disturbed to ha -> divide by landscape area -> convert to %
summarise(dist.dyn = mean(area_disturbed/100/area*100),
n_year = length(unique(year))) ,
by=c("climate", "rep", "size", "freq", "browsing", "fecundity", "landscape")) %>%
rename('1. Structure\nBasal area decreased by >50 % from reference' = 9,
'2. Composition\nDominant species changed from reference' = 10,
'3. Remaining forest\nStem density dropping below 50 trees/ha' = 11) %>%
pivot_longer(9:11) %>%
mutate(dist.dyn = ifelse(is.na(dist.dyn), 0, dist.dyn))
head(dist.dyn.df_climate)
dist.dyn.df_climate$dist.dyn %>% summary() # chose sensible labels
dist.dyn.df_climate  %>%
ggplot(aes(x = dist.dyn, y = value*100, col=climate)) +
geom_point(size = 0.1, alpha = 0.5) +
geom_smooth(method = "loess", se = FALSE) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2, # year 1:80 *0.5, 1:10 *2, 1:5 *5, 1:2 *10
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
facet_grid(~name) +
scale_color_manual(values=c("hotdry" = "firebrick2", "baseline"="royalblue3")) +
ylim(0, 100) +
labs(y = "Landscape unchanged [%]", col = "Climate scenario",
x = paste0("Simulated disturbance rate [% yr^-1]\nRate based on only the first ", unique(dist.dyn.df_climate$n_year)," simulation years\nAxis log10-transformed")) +
theme_bw() +
theme(legend.position = "top")
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2, # year 1:80 *0.5, 1:10 *2, 1:5 *5, 1:2 *10
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening", "Amplifying")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.effect <- dist.dyn.df_climate %>%
filter(climate=="baseline") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(baseline=value, dist.dyn_baseline=dist.dyn) %>%
full_join(dist.dyn.df_climate %>% filter(climate=="hotdry") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(hotdry=value, dist.dyn_hotdry=dist.dyn)) %>%
mutate(effect = hotdry-baseline) # positive when hotdry > baseline -> dampening effect
summary(dist.dyn.effect)
effect.background <- data.frame(interaction = factor(c("Dampening", "Amplifying"), levels=c("Dampening", "Amplifying")),
xmin = c(0, 0), xmax = c(Inf, Inf),
ymin = c(0, -Inf), ymax = c(Inf, 0))
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2, # year 1:80 *0.5, 1:10 *2, 1:5 *5, 1:2 *10
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening", "Amplifying")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.df_climate  %>%
ggplot(aes(x = dist.dyn, y = value*100, col=climate)) +
geom_point(size = 0.1, alpha = 0.5) +
geom_smooth(method = "loess", se = FALSE) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2, # year 1:80 *0.5, 1:10 *2, 1:5 *5, 1:2 *10
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
facet_grid(~name) +
scale_color_manual(values=c("hotdry" = "firebrick2", "baseline"="royalblue3")) +
ylim(0, 100) +
labs(y = "Landscape unchanged [%]", col = "Climate scenario",
x = paste0("Simulated disturbance rate [% yr^-1]\nRate based on only the first ", unique(dist.dyn.df_climate$n_year)," simulation years\nAxis log10-transformed")) +
theme_bw() +
theme(legend.position = "top")
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2, # year 1:80 *0.5, 1:10 *2, 1:5 *5, 1:2 *10
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening", "Amplifying")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
\nless landscape changed
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening\nless landscape changed", "Amplifying")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening:\nless landscape changed", "Amplifying:\nmore landscape changed")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
png("results/figures/Q2_climateEffect_disturbanceRate_10yrs.png", res=200,
height=1300, width=2000)
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening:\nless landscape changed", "Amplifying:\nmore landscape changed")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dev.off()
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100, group=landscape),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening:\nless landscape changed", "Amplifying:\nmore landscape changed")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100, col=landscape),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening:\nless landscape changed", "Amplifying:\nmore landscape changed")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
png("results/figures/Q2_climateEffect_disturbanceRate_10yrs.png", res=200,
height=1300, width=2000)
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.5) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100, col=landscape),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#266867", "Amplifying"="#f55800"),
labels = c("Dampening:\nless landscape changed", "Amplifying:\nmore landscape changed")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [%] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dev.off()
