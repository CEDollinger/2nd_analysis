geom_point(size=0.1) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_y_reverse() +
facet_grid(~name) +
labs(x="Disturbance rate [based on first 10 yrs, % yr^-1]", y="Regeneration rate\n[based on all 80 yrs, recruited trees per ha yr^-1]") +
theme_bw()
dist.dyn.effect %>%
full_join(dist.dyn.effect %>%
filter(size==1, freq==1, fecundity==100, browsing==1) %>%
group_by(landscape) %>%
summarise(dist.dyn_ref = mean(dist.dyn_baseline)) %>%
dplyr::select(landscape, dist.dyn_ref), multiple = "all", by = "landscape") %>%
mutate(dist.change = (dist.dyn_baseline - dist.dyn_ref)/dist.dyn_ref,
landscape = factor(landscape, levels=c("stoko", "bgd", "grte"))) %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=dist.change, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.change, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_wrap(landscape~name, scales="free_x") +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#018571", "Amplifying"="#143d59"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Percent change in disturbance rate [%]\nRates based on only the first 10 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
### disturbance rate ####
dist.dyn.effect <- dist.dyn.df_climate %>%
filter(climate=="baseline") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(baseline=value, dist.dyn_baseline=dist.dyn) %>%
full_join(dist.dyn.df_climate %>% filter(climate=="hotdry") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(hotdry=value, dist.dyn_hotdry=dist.dyn)) %>%
mutate(effect = hotdry-baseline) # positive when hotdry > baseline -> dampening effect
### disturbance rate ####
dist.dyn.df_climate <- bind_rows(overtime.ls[["bgd"]], overtime.ls[["grte"]],overtime.ls[["stoko"]]) %>%
filter(year==80) %>% dplyr::select(-year) %>%
full_join(patch.df %>%
filter(year %in% 1:10) %>%
group_by(climate, size, freq, browsing, fecundity, landscape, rep, area) %>%
# mean yearly disturbance rate: area_disturbed to ha -> divide by landscape area -> convert to %
summarise(dist.dyn = mean(area_disturbed/100/area*100),
n_year = length(unique(year))) ,
by=c("climate", "rep", "size", "freq", "browsing", "fecundity", "landscape")) %>%
pivot_longer(9:11) %>%
mutate(dist.dyn = ifelse(is.na(dist.dyn), 0, dist.dyn))
### disturbance rate ####
dist.dyn.effect <- dist.dyn.df_climate %>%
filter(climate=="baseline") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(baseline=value, dist.dyn_baseline=dist.dyn) %>%
full_join(dist.dyn.df_climate %>% filter(climate=="hotdry") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(hotdry=value, dist.dyn_hotdry=dist.dyn)) %>%
mutate(effect = hotdry-baseline) # positive when hotdry > baseline -> dampening effect
dist.dyn.effect %>%
full_join(dist.dyn.effect %>%
filter(size==1, freq==1, fecundity==100, browsing==1) %>%
group_by(landscape) %>%
summarise(dist.dyn_ref = mean(dist.dyn_baseline)) %>%
dplyr::select(landscape, dist.dyn_ref), multiple = "all", by = "landscape") %>%
mutate(dist.change = (dist.dyn_baseline - dist.dyn_ref)/dist.dyn_ref,
landscape = factor(landscape, levels=c("stoko", "bgd", "grte"))) %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=dist.change, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.change, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_wrap(landscape~name, scales="free_x") +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#018571", "Amplifying"="#143d59"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Percent change in disturbance rate [%]\nRates based on only the first 10 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
## Effect plot ####
effect.background <- data.frame(interaction = factor(c("Dampening", "Amplifying"), levels=c("Dampening", "Amplifying")),
xmin = c(-0, -0), xmax = c(Inf, Inf),
ymin = c(0, -Inf), ymax = c(Inf, 0))
dist.dyn.effect %>%
full_join(dist.dyn.effect %>%
filter(size==1, freq==1, fecundity==100, browsing==1) %>%
group_by(landscape) %>%
summarise(dist.dyn_ref = mean(dist.dyn_baseline)) %>%
dplyr::select(landscape, dist.dyn_ref), multiple = "all", by = "landscape") %>%
mutate(dist.change = (dist.dyn_baseline - dist.dyn_ref)/dist.dyn_ref,
landscape = factor(landscape, levels=c("stoko", "bgd", "grte"))) %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=dist.change, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.change, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_wrap(landscape~name, scales="free_x") +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#018571", "Amplifying"="#143d59"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Percent change in disturbance rate [%]\nRates based on only the first 10 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.effect %>%
full_join(dist.dyn.effect %>%
filter(size==1, freq==1, fecundity==100, browsing==1) %>%
group_by(landscape) %>%
summarise(dist.dyn_ref = mean(dist.dyn_baseline)) %>%
dplyr::select(landscape, dist.dyn_ref), multiple = "all", by = "landscape") %>%
mutate(dist.change = (dist.dyn_baseline - dist.dyn_ref)/dist.dyn_ref,
landscape = factor(landscape, levels=c("stoko", "bgd", "grte"))) %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=dist.change, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.change, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(landscape~name, scales="free_x") +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#018571", "Amplifying"="#143d59"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Percent change in disturbance rate [%]\nRates based on only the first 10 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.effect %>%
full_join(dist.dyn.effect %>%
filter(size==1, freq==1, fecundity==100, browsing==1) %>%
group_by(landscape) %>%
summarise(dist.dyn_ref = mean(dist.dyn_baseline)) %>%
dplyr::select(landscape, dist.dyn_ref), multiple = "all", by = "landscape") %>%
mutate(dist.change = (dist.dyn_baseline - dist.dyn_ref)/dist.dyn_ref,
landscape = factor(landscape, levels=c("stoko", "bgd", "grte"))) %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=dist.change, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.change, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(landscape~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Percent change in disturbance rate [%]\nRates based on only the first 10 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.effect %>%
full_join(dist.dyn.effect %>%
filter(size==1, freq==1, fecundity==100, browsing==1) %>%
group_by(landscape) %>%
summarise(dist.dyn_ref = mean(dist.dyn_baseline)) %>%
dplyr::select(landscape, dist.dyn_ref), multiple = "all", by = "landscape") %>%
mutate(dist.change = (dist.dyn_baseline - dist.dyn_ref)/dist.dyn_ref,
landscape = factor(landscape, levels=c("stoko", "bgd", "grte"))) %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.8) +
geom_point(aes(x=dist.change, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.change, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(landscape~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Percent change in disturbance rate [%]\nRates based on only the first 10 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.effect %>%
full_join(dist.dyn.effect %>%
filter(size==1, freq==1, fecundity==100, browsing==1) %>%
group_by(landscape) %>%
summarise(dist.dyn_ref = mean(dist.dyn_baseline)) %>%
dplyr::select(landscape, dist.dyn_ref), multiple = "all", by = "landscape") %>%
mutate(dist.change = (dist.dyn_baseline - dist.dyn_ref)/dist.dyn_ref,
landscape = factor(landscape, levels=c("stoko", "bgd", "grte"))) %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 1.0) +
geom_point(aes(x=dist.change, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.change, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(landscape~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Percent change in disturbance rate [%]\nRates based on only the first 10 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
# relative disturbance rate
png("results/figures/Q2_climateEffect_disturbanceRate_relative_10yrs.png", res=200,
height=1300, width=2000)
dist.dyn.effect %>%
full_join(dist.dyn.effect %>%
filter(size==1, freq==1, fecundity==100, browsing==1) %>%
group_by(landscape) %>%
summarise(dist.dyn_ref = mean(dist.dyn_baseline)) %>%
dplyr::select(landscape, dist.dyn_ref), multiple = "all", by = "landscape") %>%
mutate(dist.change = (dist.dyn_baseline - dist.dyn_ref)/dist.dyn_ref,
landscape = factor(landscape, levels=c("stoko", "bgd", "grte"))) %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 1.0) +
geom_point(aes(x=dist.change, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.change, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(landscape~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Percent change in disturbance rate [%]\nRates based on only the first 10 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dev.off()
regen.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=regen.dyn_baseline, y=effect*100, col=landscape),
size=0.05) +
# geom_smooth(aes(x=regen.dyn_baseline, y=effect*100),
#             method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_reverse() +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated regeneration rate [Mean number of tress recruited per ha yr^-1]\nRate based on all 80 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
### regeneration rate ####
regen.dyn.effect <- regen.dyn.df_climate %>%
filter(climate=="baseline") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(baseline=value, regen.dyn_baseline=regen.dyn) %>%
full_join(regen.dyn.df_climate %>% filter(climate=="hotdry") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(hotdry=value, regen.dyn_hotdry=regen.dyn)) %>%
mutate(effect = hotdry-baseline) # positive when hotdry > baseline -> dampening effect
### regeneration rate ####
regen.dyn.df_climate <- bind_rows(overtime.ls[["bgd"]], overtime.ls[["grte"]],overtime.ls[["stoko"]]) %>%
filter(year==80) %>% dplyr::select(-year) %>%
full_join(regen.df %>%
filter(year %in% 1:80) %>%
group_by(climate, size, freq, browsing, fecundity, landscape, rep, area) %>%
# mean yearly disturbance rate: area_disturbed to ha -> divide by landscape area -> convert to %
summarise(regen.dyn = mean(born),
n_year = length(unique(year))) ,
by=c("climate", "rep", "size", "freq", "browsing", "fecundity", "landscape")) %>%
pivot_longer(9:11) %>%
mutate(regen.dyn = ifelse(is.na(regen.dyn), 0, regen.dyn))
### regeneration rate ####
regen.dyn.effect <- regen.dyn.df_climate %>%
filter(climate=="baseline") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(baseline=value, regen.dyn_baseline=regen.dyn) %>%
full_join(regen.dyn.df_climate %>% filter(climate=="hotdry") %>%
dplyr::select(-climate, -identifier, -n_year) %>%
rename(hotdry=value, regen.dyn_hotdry=regen.dyn)) %>%
mutate(effect = hotdry-baseline) # positive when hotdry > baseline -> dampening effect
regen.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=regen.dyn_baseline, y=effect*100, col=landscape),
size=0.05) +
# geom_smooth(aes(x=regen.dyn_baseline, y=effect*100),
#             method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_reverse() +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated regeneration rate [Mean number of tress recruited per ha yr^-1]\nRate based on all 80 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
regen.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 1) +
geom_point(aes(x=regen.dyn_baseline, y=effect*100, col=landscape),
size=0.05) +
# geom_smooth(aes(x=regen.dyn_baseline, y=effect*100),
#             method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_reverse() +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated regeneration rate [Mean number of tress recruited per ha yr^-1]\nRate based on all 80 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
regen.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 1) +
geom_point(aes(x=regen.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=regen.dyn_baseline, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_reverse() +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated regeneration rate [Mean number of tress recruited per ha yr^-1]\nRate based on all 80 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
regen.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 1) +
geom_point(aes(x=regen.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=regen.dyn_baseline, y=effect*100, col=landscape),
method = "loess", se = F) +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_reverse() +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated regeneration rate [Mean number of tress recruited per ha yr^-1]\nRate based on all 80 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
regen.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=regen.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=regen.dyn_baseline, y=effect*100, col=landscape),
method = "loess", se = F) +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_reverse() +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated regeneration rate [Mean number of tress recruited per ha yr^-1]\nRate based on all 80 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=regen.dyn_baseline, y=effect*100, col=landscape),
method = "loess", se = F) +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#018571", "Amplifying"="#143d59"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100, col=landscape),
method = "loess", se = F) +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#018571", "Amplifying"="#143d59"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100, col=landscape),
method = "loess", se = F) +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
# absolute disturbance rate
png("results/figures/Q2_climateEffect_disturbanceRate_10yrs.png", res=200,
height=1300, width=2000)
dist.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=dist.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.dyn_baseline, y=effect*100, col=landscape),
method = "loess", se = F) +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_log10(breaks = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2,
label = c(0.0001, 0.001, 0.01, 0.1, 1, 10)*2) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated disturbance rate [% yr^-1]\nRate based on only the first 10 simulation years\nAxis log10-transformed",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dev.off()
# relative disturbance rate
png("results/figures/Q2_climateEffect_disturbanceRate_relative_10yrs.png", res=200,
height=1300, width=2000)
dist.dyn.effect %>%
full_join(dist.dyn.effect %>%
filter(size==1, freq==1, fecundity==100, browsing==1) %>%
group_by(landscape) %>%
summarise(dist.dyn_ref = mean(dist.dyn_baseline)) %>%
dplyr::select(landscape, dist.dyn_ref), multiple = "all", by = "landscape") %>%
mutate(dist.change = (dist.dyn_baseline - dist.dyn_ref)/dist.dyn_ref,
landscape = factor(landscape, levels=c("stoko", "bgd", "grte"))) %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 1.0) +
geom_point(aes(x=dist.change, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.change, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(landscape~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Percent change in disturbance rate [%]\nRates based on only the first 10 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dev.off()
# absolute regeneration rate
png("results/figures/Q2_climateEffect_regenerationRate_80yrs.png", res=200,
height=1300, width=2000)
regen.dyn.effect %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=regen.dyn_baseline, y=effect*100),
size=0.05) +
geom_smooth(aes(x=regen.dyn_baseline, y=effect*100, col=landscape),
method = "loess", se = F) +
geom_hline(aes(yintercept=0)) +
facet_grid(~name) +
scale_x_reverse() +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Simulated regeneration rate [Mean number of tress recruited per ha yr^-1]\nRate based on all 80 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dev.off()
# relative disturbance rate
png("results/figures/Q2_climateEffect_disturbanceRate_relative_10yrs.png", res=200,
height=1300, width=2000)
dist.dyn.effect %>%
full_join(dist.dyn.effect %>%
filter(size==1, freq==1, fecundity==100, browsing==1) %>%
group_by(landscape) %>%
summarise(dist.dyn_ref = mean(dist.dyn_baseline)) %>%
dplyr::select(landscape, dist.dyn_ref), multiple = "all", by = "landscape") %>%
mutate(dist.change = (dist.dyn_baseline - dist.dyn_ref)/dist.dyn_ref,
landscape = factor(landscape, levels=c("stoko", "bgd", "grte"))) %>%
ggplot() +
geom_rect(data=effect.background,
aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax, fill=interaction), alpha = 0.3) +
geom_point(aes(x=dist.change, y=effect*100),
size=0.05) +
geom_smooth(aes(x=dist.change, y=effect*100),
method = "loess", se = F, col="black") +
geom_hline(aes(yintercept=0)) +
facet_grid(landscape~name) +
scale_fill_manual(name = "Interaction type",
values = c("Dampening" = "#A1BE95", "Amplifying"="#F98866"),
labels = c("Dampening:\nless landscape broken", "Amplifying:\nmore landscape broken")) +
labs(x = "Percent change in disturbance rate [%]\nRates based on only the first 10 simulation years",
y = "Climate effect [percentage point change, %] ", title="Effect of climate on landscape unchanged compared to baseline") +
theme_bw()
dev.off()
